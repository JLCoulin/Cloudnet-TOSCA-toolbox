# A.6.2-01.yaml
tosca_definitions_version: tosca_simple_yaml_1_3
description: Complex example (uniform and non-uniform delta value) described with policies
imports:
  - etsi_nfv_sol001_vnfd_types.yaml  # all of TOSCA VNFD types as defined in ETSI GSÂ NFV-SOL 001

topology_template:
  node_templates:
    db:
      type: tosca.nodes.nfv.Vdu.Compute
      properties:
        name: ..
        description: ..
        
        vdu_profile:
          min_number_of_instances: 2
          max_number_of_instances: 6
        nfvi_constraints:
          key_1: value_1
          key_2: value_2
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              virtual_mem_size: 1 GB
            virtual_cpu:
              num_virtual_cpu: 1

    oam:
      type: tosca.nodes.nfv.Vdu.Compute
      properties:
        name: ..
        description: ..
        vdu_profile:
          min_number_of_instances: 1
          max_number_of_instances: 1
        nfvi_constraints:
          key_1: value_1
          key_2: value_2
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              virtual_mem_size: 1 GB
            virtual_cpu:
              num_virtual_cpu: 1


    processing:
      type: tosca.nodes.nfv.Vdu.Compute
      properties:
        name: ..
        description: ..
        
        vdu_profile:
          min_number_of_instances: 4
          max_number_of_instances: 12
        nfvi_constraints:
          key_1: value_1
          key_2: value_2
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              virtual_mem_size: 1 GB
            virtual_cpu:
              num_virtual_cpu: 1


    processing_auxiliary:
      type: tosca.nodes.nfv.Vdu.Compute
      properties:
        name: ..
        description: ..
        
        vdu_profile:
          min_number_of_instances: 1
          max_number_of_instances: 3
        nfvi_constraints:
          key_1: value_1
          key_2: value_2
      capabilities:
        virtual_compute:
          properties:
            virtual_memory:
              virtual_mem_size: 1 GB
            virtual_cpu:
              num_virtual_cpu: 1


  policies:
    - scaling_aspects:
        type: tosca.policies.nfv.ScalingAspects
        properties:
          aspects:
            database:
              name: ..
              description: ..
              max_scale_level: 2
              step_deltas:
                - delta_1
                - delta_1
            proc:
              name: ..
              description: ..
              max_scale_level: 4
              step_deltas:
                - delta_1
                - delta_2
                - delta_1
                - delta_2

    - db_initial_delta:
        type: tosca.policies.nfv.VduInitialDelta
        properties:
          initial_delta:
            number_of_instances: 2
        targets: [ db ]

    - db_scaling_aspect_deltas:
        type: tosca.policies.nfv.VduScalingAspectDeltas
        properties:
          aspect: database
          deltas:
            delta_1:
              number_of_instances: 2
        targets: [ db ]

    - oam_initial_delta:
        type: tosca.policies.nfv.VduInitialDelta
        properties:
          initial_delta:
            number_of_instances: 1
        targets: [ oam ]

    - processing_initial_delta:
        type: tosca.policies.nfv.VduInitialDelta
        properties:
          initial_delta:
            number_of_instances: 4
        targets: [ processing ]

    - processing_scaling_aspect_deltas:
        type: tosca.policies.nfv.VduScalingAspectDeltas
        properties:
          aspect: proc
          deltas:
            delta_1:
              number_of_instances: 2
            delta_2:
              number_of_instances: 2
        targets: [ processing ]

    - processing_auxiliary_initial_delta:
        type: tosca.policies.nfv.VduInitialDelta
        properties:
          initial_delta:
            number_of_instances: 1
        targets: [ processing_auxiliary ]

    - processing_auxiliary_scaling_aspect_deltas:
        type: tosca.policies.nfv.VduScalingAspectDeltas
        properties:
          aspect: proc
          deltas:
            delta_1:
              number_of_instances: 1
            delta_2:
              number_of_instances: 0
        targets: [ processing_auxiliary ]

    - instantiation_levels:
        type: tosca.policies.nfv.InstantiationLevels
        properties:
          levels:
            instantiation_level_1:
              description: ..
              scale_info:
                database:
                  scale_level: 0
                proc:
                  scale_level: 0

    - db_instantiation_levels:
        type: tosca.policies.nfv.VduInstantiationLevels
        properties:
          levels:
            instantiation_level_1:
              number_of_instances: 2
        targets: [ db ]

    - oam_instantiation_levels:
        type: tosca.policies.nfv.VduInstantiationLevels
        properties:
          levels:
            instantiation_level_1:
              number_of_instances: 1
        targets: [ oam ]

    - processing_instantiation_levels:
        type: tosca.policies.nfv.VduInstantiationLevels
        properties:
          levels:
            instantiation_level_1:
              number_of_instances: 4
        targets: [ processing ]

    - processing_auxiliary_instantiation_levels:
        type: tosca.policies.nfv.VduInstantiationLevels
        properties:
          levels:
            instantiation_level_1:
              number_of_instances: 1
        targets: [ processing_auxiliary ]

