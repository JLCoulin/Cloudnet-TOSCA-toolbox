# A.7.2-01.yaml
tosca_definitions_version: tosca_simple_yaml_1_3
imports:
  - etsi_nfv_sol001_nsd_types.yaml  # all of TOSCA NSD types as defined in ETSI GSÂ NFVSOL 001
  #- example_VNF2.yaml
  - example_A.14-etsi_nfv_example_vnf2.yaml


node_types:
  tosca.nodes.nfv.exampleNS: ###BC colon was missing
    derived_from: tosca.nodes.nfv.NS
    properties:
    # properties omitted for brevity
    ##### All required NS properties to be added with default values
      descriptor_id:
        type: string
        constraints: [ valid_values: [ b1bb0ce7-ebca-4fa7-95ed-4840d70a1177 ] ]
        default: b1bb0ce7-ebca-4fa7-95ed-4840d70a1177
      designer:
        type: string
        constraints: [ valid_values: [ MyCompany] ]
        default: MyCompany
      name:
        type: string
        constraints: [ valid_values: [ ExampleService ] ]
        default: ExampleService
      version:
        type: string
        constraints: [ valid_values: [ '1.0' ] ]
        default: '1.0'
      invariant_id:
        type: string
        constraints: [ valid_values: [ 1111-2222-aaaa-bbbb ] ]
        default: 1111-2222-aaaa-bbbb
      flavour_id:
        type: string
        constraints: [ valid_values: [ small, big ] ]
        default: small

    requirements:
       - virtual_link:
           capability:
#            tosca.capabilitites.nfv.VirtualLinkable # ERROR: typo!
             tosca.capabilities.nfv.VirtualLinkable

#...

topology_template:

#...

  substitution_mappings:
    node_type: tosca.nodes.nfv.exampleNS
    requirements:
      virtual_link: [VNF_2, virtual_link_2] # the External connection point of VNF_2
                                              # will be used as the Sap of this NS

  node_templates:
    VNF_2:
      type: tosca.nodes.nfv.example_VNF2
      # properties omitted for brevity
      requirements:
        - virtual_link_1: NsVirtualLink_1 # connects to the External connection
                                          # point which maps to the
                                          # virtual_link_1 requirement of VNF_2
        # - virtual_link_2: # mapped to virtual_link requirement of NS node

    NsVirtualLink_1:
      type: tosca.nodes.nfv.NsVirtualLink
      properties:
        vl_profile:
          min_bitrate_requirements:
            root: 100000
          max_bitrate_requirements:
            root: 200000
        connectivity_type:
          layer_protocols: [ ipv4 ]

  # other node template definitions
  #...
